\subsection{Exemple}

\frame{
    \tableofcontents[ 
        currentsubsection, 
        % hideothersubsections,
        % sectionstyle=show/hide,
        % subsectionstyle=show/shaded,
    ]
}

\begin{frame}{$L_{1}$ : $R(x) = \lVert x \rVert_{1}$}

Résolution avec l'ADMM:
\begin{itemize}
    \item Équation : $\min\limits_{x, z} \{ 
        \frac{1}{2} \lVert y - Hx \rVert_{2}^{2} 
        + \lambda \lVert z \rVert_{1} 
    \}$
    \item Contrainte : $x = z$
\end{itemize}

\vspace{5mm}

Lagrangien augmenté :

\begin{align*}
L(x, z, u) 
&= \frac{1}{2} \lVert y - Hx \rVert_{2}^{2} 
+ \lambda \lVert z \rVert_{1} 
+ u^{T}(x-z) + \frac{\rho}{2} \lVert x-z \rVert_{2}^{2} \\
&= \frac{1}{2} \lVert y - Hx \rVert_{2}^{2} 
+ \lambda \lVert z \rVert_{1}
+ \frac{\rho}{2} \lVert x - z + \frac{u}{\rho} \rVert_{2}^{2} 
- \frac{\lVert u \rVert_{2}^{2}}{2\rho}    
\end{align*}

\end{frame}

\begin{frame}{$L_{1}$ : $R(x) = \lVert x \rVert_{1}$}

\begin{align*}
\frac{d}{dx} \{\lVert y - Hx \rVert_{2}^{2}\}
&= -2H^{T}(y-Hx) = -2H^{T}y + 2H^{T}Hx \\
\frac{d}{dx} \{\lVert Hx - y \rVert_{2}^{2}\}
&= 2H^{T}(Hx-y) = 2H^{T}Hx - 2H^{T}y
\end{align*}
\end{frame}

\begin{frame}{$\arg\min\limits_{x} {L(x, z, u)}$}
\begin{align*}
&\frac{d}{dx} \{
    \frac{1}{2} \lVert y - Hx \rVert_{2}^{2} 
    + \lambda \lVert z \rVert_{1} 
    + \frac{\rho}{2} \lVert x - z + \frac{u}{\rho} \rVert_{2}^{2} 
    - \frac{\lVert u \rVert_{2}^{2}}{2\rho}
\} = 0 \\
&\iff -H^{T} (y - Hx) + \rho (x - z + \frac{u}{\rho}) = 0 \\
&\iff -H^{T} y + H^{T} H x + \rho x - \rho z + u = 0 \\
&\iff -H^{T} y + (H^{T}H + \rho I) x - \rho z + u = 0 \\
&\iff (H^{T}H + \rho I) x = H^{T}y + \rho z - u\\
&\iff x = (H^{T}H + \rho I)^{-1} (H^{T} y + \rho z - u) \\
\end{align*}
\end{frame}

\begin{frame}{$\arg\min\limits_{z} {L(x, z, u)}$}
\begin{align*}
&\frac{d}{dz} \{
    \frac{1}{2} \lVert y - Hx \rVert_{2}^{2} 
    + \lambda \lVert z \rVert_{1} 
    + \frac{\rho}{2} \lVert x - z + \frac{u}{\rho} \rVert_{2}^{2} 
    - \frac{\lVert u \rVert_{2}^{2}}{2\rho}
\} = 0 \\
&\iff \lambda sign(z) - \rho (x - z + \frac{u}{\rho})  = 0 \\
&\iff \lambda sign(z) - \rho x + \rho z - u  = 0 \\
&\iff \lambda sign(z) + \rho z  = \rho x + u \\
&\iff  z + \frac{\lambda}{\rho} sign(z) = x + \frac{u}{\rho} \\
&\iff  z = sign(x + \frac{u}{\rho}) 
\times max(|x + \frac{u}{\rho}| 
- \frac{\lambda}{\rho}, 0) \\
&\iff  z = Soft_{\frac{\lambda}{\rho}}(x + \frac{u}{\rho})
\end{align*}
\end{frame}

\begin{frame}{Algorithm}
\begin{algorithm}[H]
    \caption{ADMM-$L_{1}$} % \label{euclid}
    \begin{algorithmic}[1]
        \Procedure{ADMM}{}\newline
        \textbf{Input:} $y$, $\lambda$, $\rho$, $nb\_iterations$ \\
        \textbf{Output:} $x_{nb\_iterations}$
        \For{\texttt{$k \in 0...nb\_iterations$}}
            \State{$x_{k+1} = (H^{T}H + \rho I)^{-1} (H^{T} y_{k} + \rho z_{k} - u_{k})$}
            \State{$z_{k+1} = Soft_{\frac{\lambda}{\rho}}(x_{k+1} + \frac{u_{k}}{\rho})$}
            \State{$u_{k+1} = u_{k} + \rho (z_{k+1} - x_{k+1})$}
        \EndFor
        \EndProcedure
    \end{algorithmic}
    % \label{alg_1}
\end{algorithm}
\end{frame}

    
\begin{frame}{Total Variation : $R(x) = \lVert \nabla x \rVert_{1}$}

Résolution avec l'ADMM:
\begin{itemize}
    \item Équation : $\min\limits_{x, z} \{ 
        \frac{1}{2} \lVert y - Hx \rVert_{2}^{2} 
        + \lambda \lVert z \rVert_{1} 
    \}$
    \item Contrainte : $\nabla x = z$
\end{itemize}

\vspace{5mm}

Lagrangien augmenté :

\begin{align*}
L(x, z, u) 
&= \frac{1}{2} \lVert y - Hx \rVert_{2}^{2} 
+ \lambda \lVert z \rVert_{1} 
+ u^{T}(\nabla x-z) + \frac{\rho}{2} \lVert \nabla x-z \rVert_{2}^{2} \\
&= \frac{1}{2} \lVert y - Hx \rVert_{2}^{2} 
+ \lambda \lVert z \rVert_{1}
+ \frac{\rho}{2} \lVert \nabla x - z + \frac{u}{\rho} \rVert_{2}^{2} 
- \frac{\lVert u \rVert_{2}^{2}}{2\rho}    
\end{align*}

\end{frame}

% \begin{frame}{$L_{1}$ : $R(x) = \lVert x \rVert_{1}$}

% \begin{align*}
% \frac{d}{dx} \{\lVert y - Hx \rVert_{2}^{2}\}
% &= -2H^{T}(y-Hx) = -2H^{T}y + 2H^{T}Hx \\
% \frac{d}{dx} \{\lVert Hx - y \rVert_{2}^{2}\}
% &= 2H^{T}(Hx-y) = 2H^{T}Hx - 2H^{T}y
% \end{align*}
% \end{frame}

\begin{frame}{$\arg\min\limits_{x} {L(x, z, u)}$}
\begin{align*}
&\frac{d}{dx} \{
    \frac{1}{2} \lVert y - Hx \rVert_{2}^{2} 
    + \lambda \lVert z \rVert_{1} 
    + \frac{\rho}{2} \lVert \nabla x - z + \frac{u}{\rho} \rVert_{2}^{2} 
    - \frac{\lVert u \rVert_{2}^{2}}{2\rho}
\} = 0 \\
&\iff -H^{T} (y - Hx) + \rho  \nabla^{T}(\nabla x - z + \frac{u}{\rho}) = 0 \\
&\iff -H^{T} y + H^{T}Hx 
+ \rho \nabla^{T}\nabla x - \rho \nabla^{T} z + \nabla^{T} u = 0 \\
&\iff -H^{T} y + (H^{T}H + \rho \nabla^{T}\nabla) x 
- \rho \nabla^{T} z + \nabla^{T} u = 0 \\
&\iff (H^{T}H + \rho \nabla^{T}\nabla) x 
= \rho \nabla^{T} z - \nabla^{T} u + H^{T} y \\
&\iff (H^{T}H + \rho \nabla^{T}\nabla) x 
= \rho \nabla^{T} (z - \frac{u}{\rho}) + H^{T} y \\
&\iff x = (H^{T}H + \rho \nabla^{T}\nabla)^{-1} 
[\rho \nabla^{T} (z - \frac{u}{\rho}) + H^{T} y] \\
% &\iff -H^{T} y + H^{T} H x + \rho x - \rho z + u = 0 \\
% &\iff -H^{T} y + (H^{T}H + \rho I) x - \rho z + u = 0 \\
% &\iff (H^{T}H + \rho I) x = H^{T}y + \rho z - u\\
% &\iff x = (H^{T}H + \rho I)^{-1} (H^{T} y + \rho z - u) \\
\end{align*}
\end{frame}

\begin{frame}{$\arg\min\limits_{z} {L(x, z, u)}$}
\begin{align*}
&\frac{d}{dz} \{
    \frac{1}{2} \lVert y - Hx \rVert_{2}^{2} 
    + \lambda \lVert z \rVert_{1} 
    + \frac{\rho}{2} \lVert \nabla x - z + \frac{u}{\rho} \rVert_{2}^{2} 
    - \frac{\lVert u \rVert_{2}^{2}}{2\rho}
\} = 0 \\
&\iff \lambda sign(z) - \rho (\nabla x - z + \frac{u}{\rho})  = 0 \\
&\iff \lambda sign(z) - \rho \nabla x + \rho z - u  = 0 \\
&\iff \lambda sign(z) + \rho z  = \rho \nabla x + u \\
&\iff  z + \frac{\lambda}{\rho} sign(z) = \nabla x + \frac{u}{\rho} \\
&\iff  z = sign(\nabla x + \frac{u}{\rho}) 
\times max(|\nabla x + \frac{u}{\rho}| 
- \frac{\lambda}{\rho}, 0) \\
&\iff  z = Soft_{\frac{\lambda}{\rho}}(\nabla x + \frac{u}{\rho})
\end{align*}
\end{frame}

\begin{frame}{Algorithm}
\begin{algorithm}[H]
    \caption{ADMM-$L_{1}$} % \label{euclid}
    \begin{algorithmic}[1]
        \Procedure{ADMM}{}\newline
        \textbf{Input:} $y$, $\lambda$, $\rho$, $nb\_iterations$ \\
        \textbf{Output:} $x_{nb\_iterations}$
        \For{\texttt{$k \in 0...nb\_iterations$}}
            \State{$x_{k+1} = (H^{T}H + \rho \nabla^{T}\nabla)^{-1} 
                [\rho \nabla^{T} (z_{k} - \frac{u_{k}}{\rho}) + H^{T} y]$
            }
            \State{$z_{k+1} = Soft_{\frac{\lambda}{\rho}}(\nabla x_{k+1} + \frac{u_{k}}{\rho})$}
            \State{$u_{k+1} = u_{k} + \rho (z_{k+1} - x_{k+1})$}
        \EndFor
        \EndProcedure
    \end{algorithmic}
    % \label{alg_1}
\end{algorithm}
\end{frame}
    
    
    